{% extends "base.html" %}
{% load staticfiles %}


{% block title %}Students List{% endblock %}

{% block page_main_header %}Список студентов{% endblock %}

{% block nav_class_studs %}active{% endblock %}

{% block content %}

{% if messages %}
  <div class="alert alert-success my_messages">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
  </div>
{% endif %}

  <form method="GET" action="" class="search_form search_btns">
    <input type="text" name="q" placeholder="Search students" value="{{ request.GET.q }}" />
    <input type="submit" value="Search" class="btn btn-primary"/>
  </form>

  <div class="search_btns">
  <p><a href="{% url 'students:add' %}" class="btn btn-primary add_student" role="button">
  <span class="glyphicon glyphicon-plus"></span>Добавить нового студента</a></p>
  </div>

    {% if object_list %}
    <div class="container">
      <table class="table table-condensed">
        <thead>
          <tr>
            <th style="width:4%"><span class="text-muted">#</span></th>
            <th style="width:20%"><span class="text-muted">фамилия имя</span></th>
            <th style="width:20%"><span class="text-muted">адрес</span></th>
            <th style="width:10%"><span class="text-muted">skype</span></th>
            <th><span class="text-muted">курсы</span></th>
            <th><span class="text-muted"></span></th>
            <th><span class="text-muted"></span></th>
          </tr>
        </thead>
        <tbody>

<div class="container col-sm-8 col-sm-offset-2">

  <!-- Trigger the modal with a button -->
  <button type="button" id="asd" class="btn btn-info btn-lg" >Open Modal</button>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Modal Header</h4>
        </div>
        <div class="modal-body">
          <p>Some text in the modal.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save</button>
        </div>
      </div>

    </div>
  </div>

</div>

        {% for student in object_list %}
          <tr>
            <td>{{ forloop.counter|add:page_obj.start_index|add:"-1"  }}</td>
            <td><a class="styled_links" href="{% url 'students:detail' student.id %}">{{ student.surname }} {{ student.name }}</a></td>
            <td>{{ student.address }}</td>
            <td>{{ student.skype }}</td>
            <td>
              {% for courses in student.courses.all %}
                <p><a class="styled_links" href="{% url 'courses:detail' courses.id %}">{{ courses }}</a></p>
              {% endfor %}
            </td>
            <td><a href="#{% url 'students:edit' student.id %}">
                <span class="glyphicon glyphicon-pencil"></span>Изменить</a><br>
            </td>
            <td><a href="{% url 'students:remove' student.id %}">
            <span class="glyphicon glyphicon-remove"></span>Удалить</a><br>
            </td>

          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div><!-- /.container  -->

  {% if is_paginated %}
        <div class="pagination my_pag">
            <span class="page-links">
              {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">previous</a>
              {% endif %}
              <span class="page-current ">
                {% for i in paginator.page_range %}
                  {% if i == page_obj.number %}
                    <a class="pag_current_num" href="?page={{ i }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{ i }}</a>
                {% else %}
                  <a href="?page={{ i }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{ i }}</a>
                {% endif %}
                {% endfor %}
              </span>

              {% if page_obj.has_next %}
                  <a href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">next</a>
              {% endif %}

            </span>
        </div>
    {% endif %}

{% endif %}

<script type="text/javascript">
    $(".aEdit").click(function(){
      // console.log($('#asd').attr("id"));
       $.get("http://127.0.0.1:8000/getdata/",

          {
            getStudent: $(this).attr('href')
            // id: $('this').attr("href")
          },
        function(data, status){
        console.log(data['time']);
        console.log(data['studentID']);

       $("#fs").text("Time: " + data['time'])
            // alert("Data: " + data + "\nStatus: " + status);
        });
      });
      // $(".aEdit").click(function(){
      //   $.post("http://127.0.0.1:8000/get_time/",
      //   {
      //     name: "Donald Duck"
      //     // id: $('this').attr("href")
      //   },
      //   function(data,status){
      //       alert("Data: " + data + "\nStatus: " + status);
      //   });
      // });

    </script>

{% endblock content %}
